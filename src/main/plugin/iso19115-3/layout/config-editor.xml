<?xml version="1.0" encoding="UTF-8"?>
<editor xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:noNamespaceSchemaLocation="../../config-editor.xsd"
        xmlns:gn="http://www.fao.org/geonetwork"
        xmlns:gml="http://www.opengis.net/gml/3.2"
        xmlns:srv="http://standards.iso.org/iso/19115/-3/srv/2.0"
        xmlns:mdb="http://standards.iso.org/iso/19115/-3/mdb/1.0"
        xmlns:mcc="http://standards.iso.org/iso/19115/-3/mcc/1.0"
        xmlns:mri="http://standards.iso.org/iso/19115/-3/mri/1.0"
        xmlns:mmi="http://standards.iso.org/iso/19115/-3/mmi/1.0"
        xmlns:mrs="http://standards.iso.org/iso/19115/-3/mrs/1.0"
        xmlns:mrd="http://standards.iso.org/iso/19115/-3/mrd/1.0"
        xmlns:mco="http://standards.iso.org/iso/19115/-3/mco/1.0"
        xmlns:msr="http://standards.iso.org/iso/19115/-3/msr/1.0"
        xmlns:lan="http://standards.iso.org/iso/19115/-3/lan/1.0"
        xmlns:mrl="http://standards.iso.org/iso/19115/-3/mrl/1.0"
        xmlns:gex="http://standards.iso.org/iso/19115/-3/gex/1.0"
        xmlns:mdq="http://standards.iso.org/iso/19157/-2/mdq/1.0"
        xmlns:cit="http://standards.iso.org/iso/19115/-3/cit/1.0"
        xmlns:gco="http://standards.iso.org/iso/19115/-3/gco/1.0">

  <!-- Form field type configuration. Default is text. -->
  <fields>
    <for name="cit:issueIdentification" use="textarea"/>
    <for name="cit:description" use="textarea"/>
    <for name="mcc:fileDescription" use="textarea"/>
    <for name="gex:description" use="textarea"/>
    <for name="mrc:description" use="textarea"/>
    <for name="mrd:mediumNote" use="textarea"/>
    <for name="lan:description" use="textarea"/>
    <for name="mcc:description" use="textarea"/>
    <for name="msr:transformationDimensionMapping" use="textarea"/>
    <for name="msr:dimensionDescription" use="textarea"/>
    <for name="msr:orientationParameterDescription" use="textarea"/>
    <for name="cit:contactInstructions" use="textarea"/>
    <for name="mco:userNote" use="textarea"/>
    <for name="mco:handlingDescription" use="textarea"/>
    <for name="mrl:description" use="textarea"/>
    <for name="mri:abstract" use="textarea"/>
    <for name="gmd:checkPointDescription" use="textarea"/>
    <for name="mri:credit" use="textarea"/>
    <for name="mrd:description" use="textarea"/>
    <for name="gmd:evaluationMethodDescription" use="textarea"/>
    <for name="gmd:explanation" use="textarea"/>
    <for name="gmd:handlingDescription" use="textarea"/>
    <for name="mdq:measureDescription" use="textarea"/>
    <for name="gmd:purpose" use="textarea"/>
    <for name="gmd:orderingInstructions" use="textarea"/>
    <for name="mco:otherConstraints" use="textarea"/>
    <for name="mri:statement" use="textarea"/>
    <for name="mri:supplementalInformation" use="textarea"/>
    <for name="gmd:specificUsage" use="textarea"/>
    <for name="gmd:userNote" use="textarea"/>
    <for name="mco:useLimitation" use="textarea"/>
    <for name="cit:otherCitationDetails" use="textarea"/>
    <for name="mmi:maintenanceNote" use="textarea"/>
    <for name="mco:statement" use="textarea"/>
    <for name="gfc:definition" use="textarea"/>
    <for name="mri:environmentDescription" use="textarea"/>
    <for name="mdq:standaloneQualityReportDetails" use="textarea"/>
    <for name="mdq:abstract" use="textarea"/>
    <for name="mdq:statement" use="textarea"/>
    <for name="mdq:evaluationMethodDescription" use="textarea"/>
    <for name="mrl:statement" use="textarea"/>
    <for name="mri:response" use="textarea"/>
    <for name="mri:specificUsage" use="textarea"/>
    <for name="mrd:orderOptions" use="textarea"/>


    <for name="gco:Distance" use="number"/>
    <for name="gco:Decimal" use="number"/>
    <for name="gco:Integer" use="number"/>
    <for name="gco:Angle" use="number"/>
    <for name="gco:Boolean" use="checkbox"/>


    <for name="gco:Date" use="data-gn-date-picker"/>
    <for name="gco:DateTime" use="data-gn-date-picker"/>



    <!-- gmx:FileName/@src attribute -->
    <for name="src" use="data-gn-logo-selector"/>

    <for name="cit:electronicMailAddress" use="email"/>

    <for name="lan:language" use="data-gn-language-picker"/>
    <for name="lan:languageCode" use="data-gn-language-picker"/>

    <for name="lan:country" use="data-gn-country-picker"/>
    <for name="cit:country" use="data-gn-country-picker"/>

    <for name="mrs:referenceSystemIdentifier" addDirective="data-gn-crs-selector"/>

    <for name="mdb:contact" addDirective="data-gn-directory-entry-selector">
      <directiveAttributes
              data-template-add-action="true"
              data-template-type="contact"
              data-filter='{"_root": "cit:CI_Responsibility"}'
              data-variables="cit:role/cit:CI_RoleCode/@codeListValue~{role}"
              data-transformation="contact-from-iso19139-to-iso19115-3"/>
    </for>
    <for name="mri:pointOfContact" addDirective="data-gn-directory-entry-selector">
      <!--<directiveAttributes
              data-template-add-action="true"
              data-template-type="contact"
              data-filter='{"_root": "cit:CI_Responsibility"}'
              data-variables="cit:role/cit:CI_RoleCode/@codeListValue~{role}"/>-->
      <!-- To use an ISO19139 contact directory in an ISO19115-3 record
      use the following configuration: -->
      <directiveAttributes
              data-template-add-action="true"
              data-template-type="contact"
              data-filter='{"_root": "gmd:CI_ResponsibleParty"}'
              data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~{role}"
              data-transformation="contact-from-iso19139-to-iso19115-3"/>
    </for>
    <for name="mrd:distributor" addDirective="data-gn-directory-entry-selector">
      <directiveAttributes
              data-template-add-action="true"
              data-template-type="contact"
              data-filter='{"_root": "cit:CI_Responsibility"}'
              data-variables="cit:role/cit:CI_RoleCode/@codeListValue~{role}"
              data-transformation="contact-from-iso19139-to-iso19115-3"/>
    </for>
    <for name="mrl:processor" addDirective="data-gn-directory-entry-selector">
      <directiveAttributes
              data-template-add-action="true"
              data-template-type="contact"
              data-filter='{"_root": "cit:CI_Responsibility"}'
              data-variables="cit:role/cit:CI_RoleCode/@codeListValue~{role}"
              data-transformation="contact-from-iso19139-to-iso19115-3"/>
    </for>
    <for name="cit:citedResponsibleParty" addDirective="data-gn-directory-entry-selector">
      <directiveAttributes
              data-template-add-action="true"
              data-template-type="contact"
              data-filter='{"_root": "cit:CI_Responsibility"}'
              data-variables="cit:role/cit:CI_RoleCode/@codeListValue~{role}"
              data-transformation="contact-from-iso19139-to-iso19115-3"/>
    </for>


    <for name="cit:logo" addDirective="data-gn-directory-entry-selector">
      <directiveAttributes
              data-template-add-action="true"
              data-template-type="logo"
              data-filter='{"_root": "mcc:MD_BrowseGraphic"}'/>
    </for>

    <for name="mdq:report" addDirective="data-gn-directory-entry-selector">
      <directiveAttributes
              data-template-add-action="true"
              data-template-type="report"
              data-filter='{"_root": "mdq:DQ_*"}'/>
    </for>

    <for name="mri:resourceConstraints" addDirective="data-gn-directory-entry-selector">
      <directiveAttributes
              data-template-add-action="true"
              data-template-type="resourceConstraints"
              data-filter='{"_root": "mco:MD_*"}'/>
    </for>

    <for name="mri:descriptiveKeywords" addDirective="data-gn-thesaurus-selector">
      <directiveAttributes
              data-transformation="to-iso19115-3-keyword"/>
    </for>
  </fields>


  <fieldsWithFieldset>
    <name>mcc:MD_Identifier</name>
    <name>mdb:metadataStandard</name>
    <name>mdb:metadataScope</name>
    <name>mdb:dateInfo</name>
    <name>mdb:contentInfo</name>
    <name>gfc:featureType</name>
    <name>gfc:carrierOfCharacteristics</name>
    <name>gfc:listedValue</name>
    <name>mdb:alternativeMetadataReference</name>
    <name>mdb:metadataLinkage</name>
    <name>mdb:identificationInfo</name>
    <name>mdb:distributionInfo</name>
    <name>mri:descriptiveKeywords</name>
    <name>mri:thesaurusName</name>
    <name>mri:resourceConstraints</name>
    <name>mdb:spatialRepresentationInfo</name>
    <name>mri:pointOfContact</name>
    <name>mdb:dataQualityInfo</name>
    <name>mdq:result</name>
    <name>mdq:report</name>
    <name>mdb:resourceLineage</name>
    <name>cit:citedResponsibleParty</name>
    <name>cit:party</name>
    <name>cit:individual</name>
    <name>cit:logo</name>
    <name>mrd:onLine</name>
    <name>mdb:referenceSystemInfo</name>
    <name>mri:equivalentScale</name>
    <name>mri:graphicOverview</name>
    <name>msr:projection</name>
    <name>mdb:extent</name>
    <name>cit:extent</name>
    <name>gex:geographicBox</name>
    <name>gex:EX_TemporalExtent</name>
    <name>mrd:MD_Distributor</name>
    <name>srv:containsOperations</name>
    <name>srv:SV_CoupledResource</name>
    <name>mdb:metadataConstraints</name>
    <name>mdb:portrayalCatalogueInfo</name>
    <name>mri:associatedResource</name>
  </fieldsWithFieldset>

  <multilingualFields>
    <!-- In multilingual mode, define which mode
    the widget should have. If expanded, then one
    field per language is displayed. -->
    <expanded>
      <name>cit:title</name>
      <name>cit:abstract</name>
    </expanded>
    <!-- All fields in ISO could be multilingual.
    Define element to exlcude. 
    TODO: it may be relevant to have parent defined
    to restrict the list.
    -->
    <exclude>
      <name>cit:protocolRequest</name>
      <name>gex:minimumValue</name>
      <name>gex:maximumValue</name>
      <name>mrc:minValue</name>
      <name>mrc:maxValue</name>
      <name>mrc:scaleFactor</name>
      <name>mrc:offset</name>
      <name>mrc:meanValue</name>
      <name>mrc:standardDeviation</name>
      <name>gco:Real</name>
      <name>mrc:numberOfValues</name>
      <name>mrc:bitsPerValue</name>
      <name>mrc:triangulationIndicator</name>
      <name>mrc:radiometricCalibrationDataAvailability</name>
      <name>mrc:filmDistortionInformationAvailability</name>
      <name>mrc:radiometricCalibrationDataAvailability</name>
      <name>mrc:cameraCalibrationInformationAvailability</name>
      <name>mrc:lensDistortionInformationAvailability</name>
      <name>mrc:complianceCode</name>
      <name>mrc:includedWithDataset</name>
      <name>mrc:featureInstanceCount</name>
      <name>gfc:uniqueInstance</name>
      <name>mrd:density</name>
      <name>mrd:densityUnits</name>
      <name>mrd:volumes</name>
      <name>mrd:unitsOfDistribution</name>
      <name>mrd:transferSize</name>
      <name>cit:linkage</name>
      <name>cit:page</name>
      <name>mco:useLimitation</name>
      <name>mri:levelOfDetail</name>
      <name>mri:distance</name>
      <name>mri:vertical</name>
      <name>mri:angularDistance</name>
      <name>msr:controlPointAvailability</name>
      <name>msr:orientationParameterAvailability</name>
      <name>mac:averageAirTemperature</name>
      <name>mac:maxRelativeHumidity</name>
      <name>mac:maxAltitude</name>
      <name>mac:meterologicalConditions</name>
      <name>mas:schemaLanguage</name>
      <name>mas:constraintLanguage</name>
      <name>gex:extentTypeCode</name>
      <name>mdq:pass</name>
      <name>mri:denominator</name>
      <name>mcc:code</name>
      <name>gfc:typeName</name>
      <name>gfc:code</name>
      <name>gfc:valueType</name>
      <name>gco:aName</name>
      <name>gfc:isAbstract</name>
      <name>mrc:illuminationElevationAngle</name>
      <name>mrc:illuminationAzimuthAngle</name>
      <name>mrc:cloudCoverPercentage</name>
      <name>mrc:compressionGenerationQuantity</name>
      <name>cit:electronicMailAddress</name>
      <name>cit:postalCode</name>
      <name>cit:city</name>
      <name>cit:administrativeArea</name>
      <name>cit:number</name>
      <name>cit:hoursOfService</name>
      <name>cit:date</name>
      <name>mac:type</name>
      <name>msr:geometricObjectCount</name>
      <name>msr:numberOfDimensions</name>
      <name>msr:checkPointAvailability</name>
      <name>msr:dimensionSize</name>
      <name>msr:resolution</name>
      <name>msr:transformationParameterAvailability</name>
      <name>mcc:fileName</name>
      <name>mcc:fileType</name>
      <name>mcc:version</name>
      <name>cit:protocol</name>
      <name>mrd:amendmentNumber</name>
      <name>mrd:fileDecompressionTechnique</name>
      <name>mcc:codeSpace</name>
      <name>cit:edition</name>
      <name>cit:ISBN</name>
      <name>cit:ISSN</name>
      <name>mex:condition</name>
      <name>mex:maximumOccurence</name>
      <name>mex:domainValue</name>
      <name>srv:name</name>
      <name>srv:invocationName</name>
      <name>srv:serviceTypeVersion</name>
      <name>srv:operationName</name>
      <name>srv:identifier</name>
    </exclude>
  </multilingualFields>


  <!-- View configuration -->
  <views>
    <view name="default">
      <tab id="default" default="true" mode="flat">
        <section xpath="/mdb:MD_Metadata/mdb:identificationInfo"/>
        <section xpath="/mdb:MD_Metadata/mdb:contentInfo"/>
        <section xpath="/mdb:MD_Metadata/mdb:distributionInfo"/>
        <section xpath="/mdb:MD_Metadata/mdb:dataQualityInfo"/>
        <section xpath="/mdb:MD_Metadata/mdb:portrayalCatalogueInfo"/>
        <section name="mdb:MD_Metadata">
          <field xpath="/mdb:MD_Metadata/mdb:metadataIdentifier"/>
          <field xpath="/mdb:MD_Metadata/mdb:defaultLocale" or="defaultLocale"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:otherLocale" or="otherLocale"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:contact" or="contact" in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:parentMetadata" or="parentMetadata"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:metadataScope" or="metadataScope"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:alternativeMetadataReference" or="alternativeMetadataReference"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:metadataLinkage" or="metadataLinkage"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:dateInfo"/>
          <field xpath="/mdb:MD_Metadata/mdb:metadataStandard"/>
          <field xpath="/mdb:MD_Metadata/mdb:metadataProfile"/>
        </section>
      </tab>

      <!-- Elements that should not use the "flat" mode -->
      <flatModeExceptions>
        <for name="mri:descriptiveKeywords"/>
        <for name="mri:topicCategory"/>
        <for name="mri:pointOfContact"/>
        <for name="mrd:distributor"/>
        <for name="mdb:contact"/>
        <for name="mcc:processor"/>
        <for name="cit:party"/>
        <for name="cit:CI_Individual"/>
        <for name="cit:CI_Organisation"/>
      </flatModeExceptions>
    </view>
    <!--
    MedSea checkpoint view
    https://forge.ifremer.fr/mantis/view.php?id=21605
    -->
    <view name="medsea"
          upAndDownControlHidden="true"
          displayIfRecord="ends-with(mdb:MD_Metadata/mdb:metadataStandard/
                                        */cit:title/gco:CharacterString, 'Emodnet Checkpoint')">
      <thesaurusList>
        <thesaurus key="local.theme.emodnet-checkpoint.environmental.matrix" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.status" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.visibility" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.policy.visibility" maxtags="1"/>
        <thesaurus key="external.theme.inspire-theme" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.level.of.characteristics" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.production.mode" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.readyness" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.data.delivery.mechanism" maxtags="1"/>
        <thesaurus key="external.parameter.NVS.P03" maxtags="1"/>
        <thesaurus key="external.parameter.NVS.P01" maxtags="1"/>
        <thesaurus key="external.parameter.NVS.P02" maxtags="1"/>
      </thesaurusList>
      <tab id="characteristics" mode="flat" default="true">
        <section>

          <field
                  name="environmental-matrix"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                    mri:descriptiveKeywords
                    [contains(*/mri:thesaurusName/cit:CI_Citation/cit:title/gco:CharacterString,
                    'Environmental matrix')]"/>

          <section name="characteristics">

            <field
                    name="p03"
                    xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                      mri:descriptiveKeywords
                      [contains(*/mri:thesaurusName/cit:CI_Citation/cit:identifier/*/mcc:code/*/text(),
                      'NVS.P03')]"/>

            <field
                    name="p02"
                    xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                      mri:descriptiveKeywords
                      [contains(*/mri:thesaurusName/cit:CI_Citation/cit:identifier/*/mcc:code/*/text(),
                      'NVS.P02')]"/>

            <field
                    name="p01"
                    xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                      mri:descriptiveKeywords
                      [contains(*/mri:thesaurusName/cit:CI_Citation/cit:identifier/*/mcc:code/*/text(),
                      'parameter.NVS.P01')]"/>
            <field
                    name="otherP01"
                    xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                      mri:descriptiveKeywords/*
                      [contains(mri:thesaurusName/cit:CI_Citation/cit:title/gco:CharacterString,
                      'Parameter Usage Vocabulary (other)')]/mri:keyword"/>

          </section>

          <field
                  name="inspireTheme"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                    mri:descriptiveKeywords
                    [contains(*/mri:thesaurusName/cit:CI_Citation/cit:title/gco:CharacterString,
                    'INSPIRE themes')]"/>


          <field
                  name="level-of-characteristics"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                    mri:descriptiveKeywords
                    [contains(*/mri:thesaurusName/cit:CI_Citation/cit:title/gco:CharacterString,
                    'Processing level of characteristics')]"/>

          <field
                  name="production-mode"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                    mri:descriptiveKeywords
                    [contains(*/mri:thesaurusName/cit:CI_Citation/cit:title/gco:CharacterString,
                    'Production mode')]"/>
        </section>
      </tab>



      <tab id="datasources">
        <section>

          <!--
          Ne pas utiliser de référence croisée mais bien utiliser du texte libre
          pour ‘Program name’ et la liste seadatanet pour ‘Edmerp Identifier’
          (qui n’est pas encore accessible dans le template). Utiliser la balise
          XML ‘Reconnaissance’ pour le project /programme name
          <field
              name="programName"
              xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                gmd:aggregationInfo/gmd:MD_AggregateInformation[
                gmd:initiativeType/gmd:DS_InitiativeTypeCode/@codeListValue = 'program']/
                gmd:aggregateDataSetName/gmd:CI_Citation/gmd:title"/>
          <field
              name="edmerpName"
              xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                gmd:aggregationInfo/gmd:MD_AggregateInformation[
                gmd:initiativeType/gmd:DS_InitiativeTypeCode/@codeListValue = 'project']/
                gmd:aggregateDataSetName/gmd:CI_Citation/gmd:title"/>
-->

          <!--
          Do not store EDMERP in keyword anymore. Use a contact with a specific role.
          <field
                   name="edmerpName"
                   xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                 gmd:descriptiveKeywords
                 [contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/gco:CharacterString,
                 'SDN EDMERP Identifier')]"/>-->



          <field name="edmerpNameGlobal" templateModeOnly="true" notDisplayedIfMissing="true"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='edmerp']"
                 del="."
                 if="count(mdb:MD_Metadata/mdb:identificationInfo/*) > 0">
            <template>
              <values readonlyIf="count(@xlink:href) > 0">
                <key label="projectTitle"
                     xpath="*/cit:party/*/cit:name/gco:CharacterString"/>
                <key label="acronym"
                     xpath="*/cit:party/*/cit:individual/*/cit:name/gco:CharacterString"/>
                <key label="programNameWebsite"
                     xpath="*/cit:party/*/cit:contactInfo/*/cit:onlineResource/*/cit:linkage/gco:CharacterString"/>
                <key label="edmerpId"
                     xpath="cit:CI_Responsibility/@id"/>
              </values>
              <snippet>
                <mri:pointOfContact>
                  <cit:CI_Responsibility id="{{edmerpId}}">
                    <gn:copy select="cit:role"/>
                    <gn:copy select="cit:extent"/>
                    <cit:party>
                      <cit:CI_Organisation>
                        <cit:name>
                          <gco:CharacterString>{{projectTitle}}</gco:CharacterString>
                        </cit:name>
                        <cit:contactInfo>
                          <cit:CI_Contact>
                            <gn:copy select="cit:phone"/>
                            <gn:copy select="cit:address"/>
                            <cit:onlineResource>
                              <cit:CI_OnlineResource>
                                <cit:linkage>
                                  <gco:CharacterString>{{programNameWebsite}}</gco:CharacterString>
                                </cit:linkage>
                                <gn:copy select="cit:protocol"/>
                                <gn:copy select="cit:applicationProfile"/>
                                <gn:copy select="cit:name"/>
                                <gn:copy select="cit:description"/>
                                <gn:copy select="cit:function"/>
                                <gn:copy select="cit:protocolRequest"/>
                              </cit:CI_OnlineResource>
                            </cit:onlineResource>
                            <gn:copy select="cit:hoursOfService"/>
                            <gn:copy select="cit:contactInstructions"/>
                            <gn:copy select="cit:contactType"/>
                          </cit:CI_Contact>
                        </cit:contactInfo>
                        <gn:copy select="cit:logo"/>
                        <cit:individual>
                          <cit:CI_Individual>
                            <cit:name>
                              <gco:CharacterString>{{acronym}}</gco:CharacterString>
                            </cit:name>
                            <gn:copy select="cit:contactInfo"/>
                          </cit:CI_Individual>
                        </cit:individual>
                      </cit:CI_Organisation>
                    </cit:party>
                  </cit:CI_Responsibility>
                </mri:pointOfContact>
              </snippet>
            </template>
          </field>


          <action type="add"
                  name="edmerpName"
                  addDirective="data-gn-directory-entry-selector"
                  or="pointOfContact"
                  in="/mdb:MD_Metadata/mdb:identificationInfo/*"
                  if="count(mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='edmerp']) = 0">
            <directiveAttributes
                    data-template-add-action="false"
                    data-template-type="contact"
                    data-filter='{"_groupPublished": "CONTACTS_EDMERP"}'
                    data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~edmerp"
                    data-transformation="contact-from-iso19139-to-iso19115-3"/>
          </action>


          <!--<field
                  name="programName"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:credit"/>-->


          <action type="add" name="orAddEdmerpName"
                  or="pointOfContact"
                  in="/mdb:MD_Metadata/mdb:identificationInfo/*"
                  if="count(mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='edmerp']) = 0">
            <template>
              <snippet>
                <mri:pointOfContact>
                  <cit:CI_Responsibility>
                    <cit:role>
                      <cit:CI_RoleCode codeList="codeListLocation#CI_RoleCode"
                                       codeListValue="edmerp">edmerp</cit:CI_RoleCode>
                    </cit:role>
                    <cit:party>
                      <cit:CI_Organisation>
                        <cit:name>
                          <gco:CharacterString></gco:CharacterString>
                        </cit:name>
                        <cit:contactInfo>
                          <cit:CI_Contact>
                            <cit:onlineResource>
                              <cit:CI_OnlineResource>
                                <cit:linkage>
                                  <gco:CharacterString></gco:CharacterString>
                                </cit:linkage>
                              </cit:CI_OnlineResource>
                            </cit:onlineResource>
                          </cit:CI_Contact>
                        </cit:contactInfo>
                      </cit:CI_Organisation>
                    </cit:party>
                  </cit:CI_Responsibility>
                </mri:pointOfContact>
              </snippet>
            </template>
          </action>


          <!--<field
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                gmd:descriptiveKeywords
                [contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/gco:CharacterString,
                'SDN EDMO Identifier')]"/>-->

          <field name="edmoNameGlobal" templateModeOnly="true" notDisplayedIfMissing="true"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='edmo']"
                 del="."
                 if="count(mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='edmo']) != 0">
            <template>
              <values readonlyIf="count(@xlink:href) > 0">
                <key label="organisationName"
                     xpath="*/cit:party/*/cit:name/gco:CharacterString"/>
                <key label="edmoNameWebsite"
                     xpath="*/cit:party/*/cit:contactInfo/*/cit:onlineResource/*/cit:linkage/gco:CharacterString"/>
                <key label="edmoId"
                     xpath="*/@id"/>
              </values>
              <snippet>
                <mri:pointOfContact>
                  <cit:CI_Responsibility id="{{edmoId}}">
                    <gn:copy select="cit:role"/>
                    <gn:copy select="cit:extent"/>
                    <cit:party>
                      <cit:CI_Organisation>
                        <cit:name>
                          <gco:CharacterString>{{organisationName}}</gco:CharacterString>
                        </cit:name>
                        <cit:contactInfo>
                          <cit:CI_Contact>
                            <gn:copy select="cit:phone"/>
                            <gn:copy select="cit:address"/>
                            <cit:onlineResource>
                              <cit:CI_OnlineResource>
                                <cit:linkage>
                                  <gco:CharacterString>{{edmoNameWebsite}}</gco:CharacterString>
                                </cit:linkage>
                                <gn:copy select="cit:protocol"/>
                                <gn:copy select="cit:applicationProfile"/>
                                <gn:copy select="cit:name"/>
                                <gn:copy select="cit:description"/>
                                <gn:copy select="cit:function"/>
                                <gn:copy select="cit:protocolRequest"/>
                              </cit:CI_OnlineResource>
                            </cit:onlineResource>
                            <gn:copy select="cit:hoursOfService"/>
                            <gn:copy select="cit:contactInstructions"/>
                            <gn:copy select="cit:contactType"/>
                          </cit:CI_Contact>
                        </cit:contactInfo>
                        <gn:copy select="cit:logo"/>
                        <gn:copy select="cit:individual"/>
                      </cit:CI_Organisation>
                    </cit:party>
                  </cit:CI_Responsibility>
                </mri:pointOfContact>
              </snippet>
            </template>
          </field>

          <action type="add"
                  name="edmoName"
                  forceLabel="true"
                  addDirective="data-gn-directory-entry-selector"
                  or="pointOfContact"
                  in="/mdb:MD_Metadata/mdb:identificationInfo/*"
                  if="count(mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='edmo']) = 0">
            <directiveAttributes
                    data-template-add-action="false"
                    data-template-type="contact"
                    data-filter='{"_groupPublished": "CONTACTS_EDMO"}'
                    data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~edmo"
                    data-transformation="contact-from-iso19139-to-iso19115-3"/>
          </action>

          <action type="add" name="orAddEdmoName"
                  or="pointOfContact"
                  in="/mdb:MD_Metadata/mdb:identificationInfo/*"
                  if="count(mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='edmo']) = 0">
            <template>
              <snippet>
                <mri:pointOfContact>
                  <cit:CI_Responsibility>
                    <cit:role>
                      <cit:CI_RoleCode codeList="codeListLocation#CI_RoleCode"
                                       codeListValue="edmo">edmo</cit:CI_RoleCode>
                    </cit:role>
                    <cit:party>
                      <cit:CI_Organisation>
                        <cit:name>
                          <gco:CharacterString></gco:CharacterString>
                        </cit:name>
                        <cit:contactInfo>
                          <cit:CI_Contact>
                            <cit:onlineResource>
                              <cit:CI_OnlineResource>
                                <cit:linkage>
                                  <gco:CharacterString></gco:CharacterString>
                                </cit:linkage>
                              </cit:CI_OnlineResource>
                            </cit:onlineResource>
                          </cit:CI_Contact>
                        </cit:contactInfo>
                      </cit:CI_Organisation>
                    </cit:party>
                  </cit:CI_Responsibility>
                </mri:pointOfContact>
              </snippet>
            </template>
          </action>


          <!-- edmoProducerName -->
          <field name="edmoProducerName" templateModeOnly="true"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[
                                            */cit:role/*/@codeListValue = 'originator']"
                 del="."
                 if="count(mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='originator']) != 0">
            <template>
              <values readonlyIf="count(@xlink:href) > 0">
                <key label="organisationName"
                     xpath="*/cit:party/*/cit:name/gco:CharacterString"/>
                <key label="producerNameWebsite"
                     xpath="*/cit:party/*/cit:contactInfo/*/cit:onlineResource/*/cit:linkage/gco:CharacterString"/>
                <key label="edmoId"
                     xpath="*/@id"/>
              </values>
              <snippet>
                <mri:pointOfContact>
                  <cit:CI_Responsibility id="{{edmoId}}">
                    <gn:copy select="cit:role"/>
                    <gn:copy select="cit:extent"/>
                    <cit:party>
                      <cit:CI_Organisation>
                        <cit:name>
                          <gco:CharacterString>{{organisationName}}</gco:CharacterString>
                        </cit:name>
                        <cit:contactInfo>
                          <cit:CI_Contact>
                            <gn:copy select="cit:phone"/>
                            <gn:copy select="cit:address"/>
                            <cit:onlineResource>
                              <cit:CI_OnlineResource>
                                <cit:linkage>
                                  <gco:CharacterString>{{producerNameWebsite}}</gco:CharacterString>
                                </cit:linkage>
                                <gn:copy select="cit:protocol"/>
                                <gn:copy select="cit:applicationProfile"/>
                                <gn:copy select="cit:name"/>
                                <gn:copy select="cit:description"/>
                                <gn:copy select="cit:function"/>
                                <gn:copy select="cit:protocolRequest"/>
                              </cit:CI_OnlineResource>
                            </cit:onlineResource>
                            <gn:copy select="cit:hoursOfService"/>
                            <gn:copy select="cit:contactInstructions"/>
                            <gn:copy select="cit:contactType"/>
                          </cit:CI_Contact>
                        </cit:contactInfo>
                        <gn:copy select="cit:logo"/>
                        <gn:copy select="cit:individual"/>
                        <!--<cit:individual>
                          <cit:CI_Individual>
                            <cit:name>
                              <gco:CharacterString>{{acronym}}</gco:CharacterString>
                            </cit:name>
                          </cit:CI_Individual>
                        </cit:individual>-->
                      </cit:CI_Organisation>
                    </cit:party>
                  </cit:CI_Responsibility>
                </mri:pointOfContact>
              </snippet>
            </template>
          </field>


          <action type="add"
                  name="edmoProducerNameSearch"
                  forceLabel="true"
                  addDirective="data-gn-directory-entry-selector"
                  or="pointOfContact"
                  in="/mdb:MD_Metadata/mdb:identificationInfo/*"
                  if="count(mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='originator']) = 0">
            <directiveAttributes
                    data-template-add-action="false"
                    data-template-type="contact"
                    data-filter='{"_groupPublished": "CONTACTS_EDMO"}'
                    data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~originator"
                    data-transformation="contact-from-iso19139-to-iso19115-3"/>
          </action>
          <action type="add" name="orAddProducerName"
                  or="pointOfContact"
                  in="/mdb:MD_Metadata/mdb:identificationInfo/*"
                  if="count(mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='originator']) = 0">
            <template>
              <snippet>
                <mri:pointOfContact>
                  <cit:CI_Responsibility>
                    <cit:role>
                      <cit:CI_RoleCode codeList="codeListLocation#CI_RoleCode"
                                       codeListValue="originator">originator</cit:CI_RoleCode>
                    </cit:role>
                    <cit:party>
                      <cit:CI_Organisation>
                        <cit:name>
                          <gco:CharacterString></gco:CharacterString>
                        </cit:name>
                        <cit:contactInfo>
                          <cit:CI_Contact>
                            <cit:onlineResource>
                              <cit:CI_OnlineResource>
                                <cit:linkage>
                                  <gco:CharacterString></gco:CharacterString>
                                </cit:linkage>
                              </cit:CI_OnlineResource>
                            </cit:onlineResource>
                          </cit:CI_Contact>
                        </cit:contactInfo>
                      </cit:CI_Organisation>
                    </cit:party>
                  </cit:CI_Responsibility>
                </mri:pointOfContact>
              </snippet>
            </template>
          </action>


          <field name="medseaHierarchyLevel"
                 xpath="/mdb:MD_Metadata/mdb:metadataScope/mdb:MD_MetadataScope/
                          mdb:resourceScope"/>

          <text ref="dataCollection-help"/>

          <field
                  name="medseaDataSourceCatalogueName"
                  xpath="/mdb:MD_Metadata/mdb:distributionInfo/*/
                            mrd:transferOptions/*/mrd:onLine[1]/*/cit:name"/>

          <field
                  name="medseaDataSourceCatalogueURL"
                  xpath="/mdb:MD_Metadata/mdb:distributionInfo/*/
                            mrd:transferOptions/*/mrd:onLine[1]/*/cit:linkage"/>


          <field
                  name="datasourceAcronym"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:citation/*/cit:otherCitationDetails"/>

          <field
                  name="medseaTitle"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:citation/*/cit:alternateTitle"/>

          <text ref="medseaTitle-help"/>

          <field
                  name="medseaDataSourceIdentifier"
                  xpath="/mdb:MD_Metadata/mdb:distributionInfo/*/
                      mrd:transferOptions/*/mrd:onLine[2]/*/cit:name"/>
          <field
                  name="medseaDataSourceDOI"
                  xpath="/mdb:MD_Metadata/mdb:distributionInfo/*/
                  mrd:transferOptions/*/mrd:onLine[2]/*/cit:linkage"/>

          <text ref="medsea-more-help"/>

        </section>
      </tab>


      <tab id="overview">
        <section>
          <field
                  name="providerSpecification"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:purpose"/>
          <text ref="providerSpecification-help"/>

          <field
                  name="processStepReference"
                  xpath="/mdb:MD_Metadata/mdb:resourceLineage/*/mrl:statement"/>

          <field
                  name="useOfTheCharacteristics"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                          mri:citation/*/cit:identifier/*/
                          mcc:authority//*/cit:title"/>


          <field name="useByChallenges"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                mri:descriptiveKeywords
                [contains(*/mri:thesaurusName/*/cit:title/gco:CharacterString,
                'Used by challenges')]"/>

          <field
                  name="intendedUse"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                  mri:environmentDescription"/>

        </section>
      </tab>
      <tab id="spatialCoverage" mode="flat">
        <section name="selectRegion">
          <!--<field
              name="geographicalAreaCode"
              xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
              mri:extent/*/gex:description"/>-->
          <field
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
              mri:extent/*/gex:geographicElement/gex:EX_GeographicBoundingBox"/>


        </section>
        <section name="horizontalAndVerticalInfo">


          <!-- Note there is a mri:MD_Resolution_TypeCHOICE_ELEMENT0
           in the metadocument to take care of in the XPath -->
          <field
                  name="horResolution"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                            mri:spatialResolution/mri:MD_Resolution/mri:distance"/>

          <field
                  name="minDepth"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                            mri:extent/*/
                            gex:verticalElement/*/gex:minimumValue"/>

          <field
                  name="maxDepth"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                            mri:extent/*/
                            gex:verticalElement/*/gex:maximumValue"/>

          <field
                  name="verticalResolution"
                  xpath="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/
                            msr:MD_Georectified/msr:numberOfDimensions"/>


          <field name="listOfObservationLevel"
                 xpath="/mdb:MD_Metadata/mdb:contentInfo/
                            mrc:MD_CoverageDescription/mrc:attributeGroup/*/
                            mrc:attribute/mrc:MD_RangeDimension/mrc:description"/>

          <text ref="listOfOL-help"/>
        </section>
      </tab>
      <tab id="timeCoverage">
        <section>


          <field name="temporalExtent" templateModeOnly="true"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:extent/*/gex:temporalElement"
                 if="count(mdb:MD_Metadata/mdb:identificationInfo/*) > 0">
            <template>
              <values>
                <!-- -Need a * for gml:TimePeriodTypeCHOICE_ELEMENT2 added by editor enumerated tree -->
                <key label="beginPosition"
                     xpath="gex:EX_TemporalExtent/gex:extent/gml:TimePeriod/*/gml:beginPosition"
                     use="gn-date-picker"
                     tooltip="gex:extent|gex:EX_TemporalExtent">
                  <directiveAttributes data-tag-name="gml:beginPosition"/>
                </key>
                <key label="endPosition"
                     xpath="gex:EX_TemporalExtent/gex:extent/gml:TimePeriod/*/gml:endPosition"
                     use="gn-date-picker"
                     tooltip="gex:extent|gex:EX_TemporalExtent"
                        >
                  <directiveAttributes
                          data-tag-name="gml:endPosition"
                          data-indeterminate-position="eval#gex:EX_TemporalExtent/gex:extent/gml:TimePeriod/*/gml:endPosition/@indeterminatePosition"/>
                </key>
              </values>
              <snippet>
                <gex:temporalElement>
                  <gex:EX_TemporalExtent>
                    <gex:extent>
                      <gml:TimePeriod gml:id="">
                        {{beginPosition}}
                        {{endPosition}}
                      </gml:TimePeriod>
                    </gex:extent>
                  </gex:EX_TemporalExtent>
                </gex:temporalElement>
              </snippet>
            </template>
          </field>

          <text ref="temporalExtent-help"/>

          <field
                  name="timeResolution"
                  xpath="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_Georectified/
                            msr:axisDimensionProperties/msr:MD_Dimension/msr:resolution"/>
          <field
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:resourceMaintenance/*/mmi:maintenanceAndUpdateFrequency"/>

        </section>
      </tab>
      <tab id="accessibility" mode="flat">
        <section name="datasetVisibility">

          <field name="visibility"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                          mri:descriptiveKeywords
                          [contains(*/mri:thesaurusName/cit:CI_Citation/cit:identifier/*/mcc:code/*/text(),
                          'emodnet-checkpoint.visibility')]"/>

          <field
                  name="serviceExtent"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                          mri:descriptiveKeywords
                          [contains(*/mri:thesaurusName/cit:CI_Citation/cit:identifier/*/mcc:code/*/text(),
                          'theme.emodnet-checkpoint.service.extent')]"/>
        </section>
        <section name="datasetAccessibility">
          <field name="policyVisibility"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                          mri:descriptiveKeywords
                          [contains(*/mri:thesaurusName/cit:CI_Citation/cit:identifier/*/mcc:code/*/text(),
                          'emodnet-checkpoint.policy.visibility')]"/>

          <field name="dataDelivery"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                          mri:descriptiveKeywords
                          [contains(*/mri:thesaurusName/cit:CI_Citation/cit:title/gco:CharacterString,
                          'Data delivery mechanism')]"/>

          <field
                  name="dataPolicy"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                          mri:resourceConstraints/mco:MD_LegalConstraints/mco:otherConstraints"/>


          <field
                  name="costBasis"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                            mri:resourceConstraints/mco:MD_Constraints/mco:useLimitation"/>



          <field name="readyness"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                          mri:descriptiveKeywords
                          [contains(*/mri:thesaurusName/cit:CI_Citation/cit:identifier/*/mcc:code/*/text(),
                          'emodnet-checkpoint.readyness')]"/>


          <field
                  name="dataFormats"
                  templateModeOnly="true"
                  xpath="/mdb:MD_Metadata/mdb:distributionInfo/*/mrd:distributionFormat/
                            mrd:MD_Format/mrd:formatSpecificationCitation"
                  del="../..">
            <template>
              <values>
                <key label="format"
                     xpath="cit:CI_Citation/cit:title/gco:CharacterString"
                     tooltip="cit:title">
                  <helper name="cit:title" context="/mdb:MD_Metadata/mdb:distributionInfo/mrd:MD_Distribution/mrd:distributionFormat/mrd:MD_Format/mrd:formatSpecificationCitation/cit:CI_Citation/cit:title"/>
                </key>
              </values>
              <snippet>
                <mrd:formatSpecificationCitation>
                  <cit:CI_Citation>
                    <cit:title>
                      <gco:CharacterString>{{format}}</gco:CharacterString>
                    </cit:title>
                  </cit:CI_Citation>
                </mrd:formatSpecificationCitation>
              </snippet>
            </template>
          </field>
         <!-- <field
                  name="dataFormats"
                  xpath="/mdb:MD_Metadata/mdb:distributionInfo/*/mrd:distributionFormat"/>-->

          <text ref="dataFormats-help"/>

          <action type="add" name="dataFormats" or="distributionFormat"
                  in="/mdb:MD_Metadata/mdb:distributionInfo/mrd:MD_Distribution">
            <template>
              <snippet>
                <mrd:distributionFormat>
                  <mrd:MD_Format>
                    <mrd:formatSpecificationCitation>
                      <cit:CI_Citation>
                        <cit:title>
                          <gco:CharacterString></gco:CharacterString>
                        </cit:title>
                      </cit:CI_Citation>
                    </mrd:formatSpecificationCitation>
                  </mrd:MD_Format>
                </mrd:distributionFormat>
              </snippet>
            </template>
          </action>
        </section>


        <section name="datasetPerf">
          <field name="responsiveness"
                 xpath="/mdb:MD_Metadata/mdb:dataQualityInfo/*/
                      mdq:report/mdq:DQ_DomainConsistency[mdq:measure/*/mdq:nameOfMeasure/gco:CharacterString = 'Responsiveness']/
                      mdq:result/mdq:DQ_QuantitativeResult/mdq:value"/>

          <!--<field name="losi"
                 xpath="/mdb:MD_Metadata/mdb:dataQualityInfo/*/
                      mdq:report/mdq:DQ_DomainConsistency[mdq:measure/*/mdq:nameOfMeasure/gco:CharacterString = 'Reliability']/
                      mdq:result/mdq:DQ_QuantitativeResult/mdq:value"/>

          <field
                  name="reliability"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                            mri:descriptiveKeywords
                            [contains(*/mri:thesaurusName/cit:CI_Citation/cit:identifier/*/mcc:code/*/text(),
                            'theme.emodnet-checkpoint.reliability')]"/>-->
        </section>
      </tab>
      <tab id="medsea-metadata" mode="flat">
        <section>

          <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:citation/cit:CI_Citation/cit:title"/>

          <!--<field
                  name="uniqueIdentifier"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                gmd:citation/gmd:CI_Citation/gmd:identifier/gmd:MD_Identifier/gmd:code"/>-->

          <!--<field name="additionalInfo"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:abstract"/>
-->
          <!--<field xpath="/mdb:MD_Metadata/mdb:defaultLocale/lan:PT_Locale/lan:language"-->
                 <!--or="defaultLocale" in="/mdb:MD_Metadata"/>-->
          <!--<field xpath="/mdb:MD_Metadata/mdb:contact" or="contact" in="/mdb:MD_Metadata"/>-->



          <!--<action type="add" name="metadataPointOfContact"
                  addDirective="data-gn-directory-entry-selector" or="contact" in="/mdb:MD_Metadata">

            <directiveAttributes
                    data-template-add-action="false"
                    data-template-type="contact"
                    data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~{{role}}"
                    data-transformation="contact-from-iso19139-to-iso19115-3"/>
          </action>-->

          <field name="metadataPointOfContact"
                 templateModeOnly="true"
                 notDisplayedIfMissing="true"
                 xpath="/mdb:MD_Metadata/mdb:contact"
                 del=".">
            <template>
              <values readonlyIf="count(@xlink:href) > 0">
                <key label="organisationName"
                     xpath="*/cit:party/*/cit:name/gco:CharacterString"/>
                <key label="electronicMailAddress"
                     xpath="*/cit:party/*/cit:contactInfo/*/cit:address/*/cit:electronicMailAddress/gco:CharacterString"
                     use="email"/>
                <key label="phone"
                     xpath="*/cit:party/*/cit:contactInfo/*/cit:phone/*[cit:numberType/*/@codeListValue = 'voice']/cit:number/gco:CharacterString"
                     use="text"/>
              </values>
              <snippet>
                <mdb:contact>
                  <cit:CI_Responsibility>
                    <gn:copy select="cit:role"/>
                    <gn:copy select="cit:extent"/>
                    <cit:party>
                      <cit:CI_Organisation>
                        <cit:name>
                          <gco:CharacterString>{{organisationName}}</gco:CharacterString>
                        </cit:name>
                        <cit:contactInfo>
                          <cit:CI_Contact>
                            <cit:phone>
                              <cit:CI_Telephone>
                                <cit:number>
                                  <gco:CharacterString>{{phone}}</gco:CharacterString>
                                </cit:number>
                                <cit:numberType>
                                  <cit:CI_TelephoneTypeCode codeList="http://standards.iso.org/ittf/PubliclyAvailableStandards/ISO_19139_Schemas/resources/codelist/ML_gmxCodelists.xml#CI_TelephoneTypeCode"
                                                            codeListValue="voice"/>
                                </cit:numberType>
                              </cit:CI_Telephone>
                            </cit:phone>
                            <!--<gn:copy select="cit:phone"/>-->
                            <cit:address>
                              <cit:CI_Address>
                                <cit:electronicMailAddress>
                                  <gco:CharacterString>{{electronicMailAddress}}</gco:CharacterString>
                                </cit:electronicMailAddress>
                              </cit:CI_Address>
                            </cit:address>
                            <gn:copy select="cit:onlineResource"/>
                            <gn:copy select="cit:hoursOfService"/>
                            <gn:copy select="cit:contactInstructions"/>
                            <gn:copy select="cit:contactType"/>
                          </cit:CI_Contact>
                        </cit:contactInfo>
                        <gn:copy select="cit:logo"/>
                        <gn:copy select="cit:individual"/>
                      </cit:CI_Organisation>
                    </cit:party>
                  </cit:CI_Responsibility>
                </mdb:contact>
              </snippet>
            </template>
          </field>


          <!-- MedSea challenges
          TODO: Can't define to use Anchor mode by default
          in keyword selector.
          <field
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                gmd:descriptiveKeywords
                [contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/gco:CharacterString,
                'Challenges')]"/>
          -->
          <field name="challenge" xpath="/mdb:MD_Metadata/mdb:metadataScope/mdb:MD_MetadataScope/mdb:name"/>

          <field xpath="/mdb:MD_Metadata/mdb:dateInfo[*/cit:dateType/*/@codeListValue = 'revision']"/>


          <field
                  name="validation"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                    mri:descriptiveKeywords
                    [contains(*/mri:thesaurusName/cit:CI_Citation/cit:identifier/*/mcc:code/*/text(),
                    'emodnet-checkpoint.status')]"/>

          <!--<field name="lineage"
                 xpath="/mdb:MD_Metadata/mdb:dataQualityInfo/*/
                    gmd:lineage/gmd:LI_Lineage/gmd:statement"/>-->
        </section>
      </tab>
      <!--<tab id="medsea-dq" mode="flat">
        <section>
          <field xpath="/mdb:MD_Metadata/mdb:dataQualityInfo/mdq:DQ_DataQuality/
                     mdq:report" or="report" in="/mdb:MD_Metadata/mdb:dataQualityInfo/mdq:DQ_DataQuality"/>

        </section>
      </tab>-->
    </view>



    <view name="medsea-targeted-product"
          upAndDownControlHidden="true"
          displayIfRecord="contains(mdb:MD_Metadata/mdb:metadataStandard/
                                        */cit:title/gco:CharacterString, 'Emodnet Checkpoint - Targeted Product')">

      <thesaurusList>
        <thesaurus key="local.theme.emodnet-checkpoint.environmental.matrix" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.status" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.visibility" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.policy.visibility" maxtags="1"/>
        <thesaurus key="external.theme.inspire-theme" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.level.of.characteristics" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.production.mode" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.readyness" maxtags="1"/>
        <thesaurus key="local.theme.emodnet-checkpoint.data.delivery.mechanism" maxtags="1"/>
      </thesaurusList>
      <tab id="medsea-what" mode="flat" default="true">
        <section>

          <field
                  name="environmental-matrix"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                    mri:descriptiveKeywords
                    [contains(*/mri:thesaurusName/cit:CI_Citation/cit:title/gco:CharacterString,
                    'Environmental matrix')]"/>

          <field
                  name="inspireTheme"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                    mri:descriptiveKeywords
                    [contains(*/mri:thesaurusName/cit:CI_Citation/cit:title/gco:CharacterString,
                    'INSPIRE themes')]"/>


          <field
                  name="level-of-characteristics"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                    mri:descriptiveKeywords
                    [contains(*/mri:thesaurusName/cit:CI_Citation/cit:title/gco:CharacterString,
                    'Processing level of characteristics')]"/>

          <field
                  name="production-mode"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                    mri:descriptiveKeywords
                    [contains(*/mri:thesaurusName/cit:CI_Citation/cit:title/gco:CharacterString,
                    'Production mode')]"/>


          <!--
          + Hierarchy data level
          + Purpose of production
          + Challenge
          + Product specification reference
          + = Lineage (cf. associated panel for sources)
          -->

          <field name="medseaHierarchyLevel"
                 xpath="/mdb:MD_Metadata/mdb:metadataScope/mdb:MD_MetadataScope/
                          mdb:resourceScope"/>

          <field
                  name="providerSpecification"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:purpose"/>


          <field name="challenge" xpath="/mdb:MD_Metadata/mdb:metadataScope/mdb:MD_MetadataScope/mdb:name"/>

          <field
                  name="processStepReference"
                  xpath="/mdb:MD_Metadata/mdb:resourceLineage/*/mrl:statement"/>


        </section>
      </tab>


      <tab id="medsea-upstream-data">
        <section>
          <text ref="medsea-upstream-data-help"/>
        </section>
      </tab>

      <tab id="medsea-who">
        <section>
          <field name="edmerpName" templateModeOnly="true" notDisplayedIfMissing="true"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='edmerp']"
                 del="."
                 if="count(mdb:MD_Metadata/mdb:identificationInfo/*) > 0">
            <template>
              <values readonlyIf="true()">
                <key label="projectTitle"
                     xpath="*/cit:party/*/cit:name/gco:CharacterString"/>
                <key label="acronym"
                     xpath="*/cit:party/*/cit:individual/*/cit:name/gco:CharacterString"/>
                <key label="edmerpId"
                     xpath="cit:CI_Responsibility/@id"/>
                <key label="programNameWebsite"
                     xpath="*/cit:party/*/cit:individual/*/cit:name/gco:CharacterString"/>
              </values>
              <snippet>
                <mri:pointOfContact>
                  <cit:CI_Responsibility id="{{edmerpId}}">
                    <gn:copy select="cit:role"/>
                    <gn:copy select="cit:extent"/>
                    <cit:party>
                      <cit:CI_Organisation>
                        <cit:name>
                          <gco:CharacterString>{{projectTitle}}</gco:CharacterString>
                        </cit:name>
                        <cit:contactInfo>
                          <cit:CI_Contact>
                            <gn:copy select="cit:phone"/>
                            <gn:copy select="cit:address"/>
                            <cit:onlineResource>
                              <cit:CI_OnlineResource>
                                <cit:linkage>
                                  <gco:CharacterString>{{website}}</gco:CharacterString>
                                </cit:linkage>
                                <gn:copy select="cit:protocol"/>
                                <gn:copy select="cit:applicationProfile"/>
                                <gn:copy select="cit:name"/>
                                <gn:copy select="cit:description"/>
                                <gn:copy select="cit:function"/>
                                <gn:copy select="cit:protocolRequest"/>
                              </cit:CI_OnlineResource>
                            </cit:onlineResource>
                            <gn:copy select="cit:hoursOfService"/>
                            <gn:copy select="cit:contactInstructions"/>
                            <gn:copy select="cit:contactType"/>
                          </cit:CI_Contact>
                        </cit:contactInfo>
                        <gn:copy select="cit:logo"/>
                        <cit:individual>
                          <cit:CI_Individual>
                            <cit:name>
                              <gco:CharacterString>{{acronym}}</gco:CharacterString>
                            </cit:name>
                            <gn:copy select="cit:contactInfo"/>
                          </cit:CI_Individual>
                        </cit:individual>
                      </cit:CI_Organisation>
                    </cit:party>
                  </cit:CI_Responsibility>
                </mri:pointOfContact>
              </snippet>
            </template>
          </field>


          <action type="add"
                  name="edmerpName"
                  forceLabel="true"
                  addDirective="data-gn-directory-entry-selector"
                  or="pointOfContact"
                  in="/mdb:MD_Metadata/mdb:identificationInfo/*"
                  if="count(mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='edmerp']) = 0">
            <directiveAttributes
                    data-template-add-action="false"
                    data-template-type="contact"
                    data-filter='{"_groupPublished": "CONTACTS_EDMERP"}'
                    data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~edmerp"
                    data-transformation="contact-from-iso19139-to-iso19115-3"/>
          </action>

          <text ref="edmerp-help"/>

          <!--<field
                  name="programName"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:credit"/>
-->

          <!--<field
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                gmd:descriptiveKeywords
                [contains(gmd:MD_Keywords/gmd:thesaurusName/gmd:CI_Citation/gmd:title/gco:CharacterString,
                'SDN EDMO Identifier')]"/>-->

          <field name="edmoName" templateModeOnly="true" notDisplayedIfMissing="true"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='edmo']"
                 del="."
                 if="count(mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='edmo']) != 0">
            <template>
              <values readonlyIf="true()">
                <key label="organisationName"
                     xpath="*/cit:party/*/cit:name/gco:CharacterString"/>
                <key label="edmoId"
                     xpath="*/@id"/>
              </values>
              <snippet>
                <mri:pointOfContact>
                  <cit:CI_Responsibility id="{{edmoId}}">
                    <gn:copy select="cit:role"/>
                    <gn:copy select="cit:extent"/>
                    <cit:party>
                      <cit:CI_Organisation>
                        <cit:name>
                          <gco:CharacterString>{{organisationName}}</gco:CharacterString>
                        </cit:name>
                        <gn:copy select="cit:contactInfo"/>
                        <gn:copy select="cit:logo"/>
                        <gn:copy select="cit:individual"/>
                      </cit:CI_Organisation>
                    </cit:party>
                  </cit:CI_Responsibility>
                </mri:pointOfContact>
              </snippet>
            </template>
          </field>
          <action type="add"
                  name="edmoName"
                  forceLabel="true"
                  addDirective="data-gn-directory-entry-selector"
                  or="pointOfContact"
                  in="/mdb:MD_Metadata/mdb:identificationInfo/*"
                  if="count(mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='edmo']) = 0">
            <directiveAttributes
                    data-template-add-action="false"
                    data-template-type="contact"
                    data-filter='{"_groupPublished": "CONTACTS_EDMO"}'
                    data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~edmo"
                    data-transformation="contact-from-iso19139-to-iso19115-3"/>
          </action>



          <field name="dataProvider" templateModeOnly="true"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[
                 */cit:role/*/@codeListValue = 'resourceProvider']">
            <template>
              <values readonlyIf="count(@xlink:href) > 0">
                <key label="organisationName"
                     xpath="*/cit:party/*/cit:name/gco:CharacterString"/>
              </values>
              <snippet>

                <mri:pointOfContact>
                  <cit:CI_Responsibility>
                    <gn:copy select="cit:role"/>
                    <gn:copy select="cit:extent"/>
                    <cit:party>
                      <cit:CI_Organisation>
                        <cit:name>
                          <gco:CharacterString>{{organisationName}}</gco:CharacterString>
                        </cit:name>
                        <gn:copy select="cit:contactInfo"/>
                        <gn:copy select="cit:logo"/>
                        <cit:individual>
                          <cit:CI_Individual>
                            <cit:name>
                              <gco:CharacterString>{{acronym}}</gco:CharacterString>
                            </cit:name>
                            <gn:copy select="cit:contactInfo"/>
                          </cit:CI_Individual>
                        </cit:individual>
                      </cit:CI_Organisation>
                    </cit:party>
                  </cit:CI_Responsibility>
                </mri:pointOfContact>
              </snippet>
            </template>
          </field>

          <!-- edmoProducerName -->
          <field name="edmoProducerName" templateModeOnly="true"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[
                                            */cit:role/*/@codeListValue = 'originator']"
                 del="."
                 if="count(mdb:MD_Metadata/mdb:identificationInfo/*/mri:pointOfContact[*/cit:role/*/@codeListValue='originator']) != 0">
            <template>
              <values readonlyIf="count(@xlink:href) > 0">
                <key label="organisationName"
                     xpath="*/cit:party/*/cit:name/gco:CharacterString"/>
              </values>
              <snippet>
                <mri:pointOfContact>
                  <cit:CI_Responsibility>
                    <gn:copy select="cit:role"/>
                    <gn:copy select="cit:extent"/>
                    <cit:party>
                      <cit:CI_Organisation>
                        <cit:name>
                          <gco:CharacterString>{{organisationName}}</gco:CharacterString>
                        </cit:name>
                        <gn:copy select="cit:contactInfo"/>
                        <gn:copy select="cit:logo"/>
                        <gn:copy select="cit:individual"/>
                        <!--<cit:individual>
                          <cit:CI_Individual>
                            <cit:name>
                              <gco:CharacterString>{{acronym}}</gco:CharacterString>
                            </cit:name>
                          </cit:CI_Individual>
                        </cit:individual>-->
                      </cit:CI_Organisation>
                    </cit:party>
                  </cit:CI_Responsibility>
                </mri:pointOfContact>
              </snippet>
            </template>
          </field>

          <action type="add"
                  name="edmoProducerNameSearch"
                  forceLabel="true"
                  addDirective="data-gn-directory-entry-selector"
                  or="pointOfContact"
                  in="/mdb:MD_Metadata/mdb:identificationInfo/*">
            <directiveAttributes
                    data-template-add-action="false"
                    data-template-type="contact"
                    data-filter='{"_groupPublished": "CONTACTS_EDMO"}'
                    data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~originator"
                    data-transformation="contact-from-iso19139-to-iso19115-3"/>
          </action>
          <action type="add" name="producerName"
                  or="pointOfContact"
                  in="/mdb:MD_Metadata/mdb:identificationInfo/*">
            <template>
              <snippet>
                <mri:pointOfContact>
                  <cit:CI_Responsibility>
                    <cit:role>
                      <cit:CI_RoleCode codeList="codeListLocation#CI_RoleCode"
                                       codeListValue="originator">originator</cit:CI_RoleCode>
                    </cit:role>
                    <cit:party>
                      <cit:CI_Organisation>
                        <cit:name>
                          <gco:CharacterString></gco:CharacterString>
                        </cit:name>
                        <cit:contactInfo>
                          <cit:CI_Contact>
                            <cit:address>
                              <cit:CI_Address>
                                <cit:electronicMailAddress gco:nilReason="missing">
                                  <gco:CharacterString/>
                                </cit:electronicMailAddress>
                              </cit:CI_Address>
                            </cit:address>
                          </cit:CI_Contact>
                        </cit:contactInfo>
                      </cit:CI_Organisation>
                    </cit:party>
                  </cit:CI_Responsibility>
                </mri:pointOfContact>
              </snippet>
            </template>
          </action>


          <field
                  name="medseaTitle"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:citation/*/cit:alternateTitle"/>

        </section>
      </tab>
      <tab id="medsea-where" mode="flat">
        <section>
          <field
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
              mri:extent/*/gex:geographicElement/gex:EX_GeographicBoundingBox"/>
        </section>
        <section name="horizontalAndVerticalInfo">
          <field
                  name="horResolution"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                            mri:spatialResolution/mri:MD_Resolution/*/mri:distance"/>

          <field
                  name="minDepth"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                            mri:extent/*/
                            gex:verticalElement/*/gex:minimumValue"/>

          <field
                  name="maxDepth"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                            mri:extent/*/
                            gex:verticalElement/*/gex:maximumValue"/>

          <field
                  name="verticalResolution"
                  xpath="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/
                            msr:MD_Georectified/msr:numberOfDimensions"/>


          <field name="listOfObservationLevel"
                 xpath="/mdb:MD_Metadata/mdb:contentInfo/
                            mrc:MD_CoverageDescription/mrc:attributeGroup/*/
                            mrc:attribute/mrc:MD_RangeDimension/mrc:description"/>
        </section>
      </tab>
      <tab id="medsea-when">
        <section>
          <!--
          + Date de création
          + Date de validité
          -->
          <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                          mri:citation/*/cit:date[
                            */cit:dateType/*/@codeListValue = 'creation' or
                            */cit:dateType/*/@codeListValue = 'revision']"/>

          <field name="temporalExtent" templateModeOnly="true"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:extent/*/gex:temporalElement"
                 if="count(mdb:MD_Metadata/mdb:identificationInfo/*) > 0">
            <template>
              <values>
                <!-- -Need a * for gml:TimePeriodTypeCHOICE_ELEMENT2 added by editor enumerated tree -->
                <key label="beginPosition"
                     xpath="gex:EX_TemporalExtent/gex:extent/gml:TimePeriod/*/gml:beginPosition"
                     use="gn-date-picker"
                     tooltip="gex:extent|gex:EX_TemporalExtent">
                  <directiveAttributes data-tag-name="gml:beginPosition"/>
                </key>
                <key label="endPosition"
                     xpath="gex:EX_TemporalExtent/gex:extent/gml:TimePeriod/*/gml:endPosition"
                     use="gn-date-picker"
                     tooltip="gex:extent|gex:EX_TemporalExtent"
                        >
                  <directiveAttributes
                          data-tag-name="gml:endPosition"
                          data-indeterminate-position="eval#gex:EX_TemporalExtent/gex:extent/gml:TimePeriod/*/gml:endPosition/@indeterminatePosition"/>
                </key>
              </values>
              <snippet>
                <gex:temporalElement>
                  <gex:EX_TemporalExtent>
                    <gex:extent>
                      <gml:TimePeriod gml:id="">
                        {{beginPosition}}
                        {{endPosition}}
                      </gml:TimePeriod>
                    </gex:extent>
                  </gex:EX_TemporalExtent>
                </gex:temporalElement>
              </snippet>
            </template>
          </field>


          <field
                  name="timeResolution"
                  xpath="/mdb:MD_Metadata/mdb:spatialRepresentationInfo/msr:MD_Georectified/
                            msr:axisDimensionProperties/msr:MD_Dimension/msr:resolution"/>
          <field
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:resourceMaintenance/*/mmi:maintenanceAndUpdateFrequency"/>

        </section>
      </tab>
      <tab id="medsea-access">
        <section>
          <field
                  name="dataPolicy"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                          mri:resourceConstraints/mco:MD_LegalConstraints/mco:otherConstraints"/>


          <field
                  name="costBasis"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                            mri:resourceConstraints/mco:MD_Constraints/mco:useLimitation"/>



          <field
                  name="dataFormats"
                  xpath="/mdb:MD_Metadata/mdb:distributionInfo/*/mrd:distributionFormat/
                            mrd:MD_Format/mrd:formatSpecificationCitation"/>


          <action type="add" name="dataFormats" or="distributionFormat"
                  in="/mdb:MD_Metadata/mdb:distributionInfo/*">
            <template>
              <snippet>
                <mrd:distributionFormat>
                  <mrd:MD_Format>
                    <mrd:formatSpecificationCitation>
                      <cit:CI_Citation>
                        <cit:title>
                          <gco:CharacterString>GML</gco:CharacterString>
                        </cit:title>
                      </cit:CI_Citation>
                    </mrd:formatSpecificationCitation>
                  </mrd:MD_Format>
                </mrd:distributionFormat>
              </snippet>
            </template>
          </action>
          <!-- TODO
          + Contraintes d’utilisation
          + Contraintes d’accès - which element ?
          + Online ressources - using associated resources panel ?
          + Citation (format)
          -->

          <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                            mri:resourceConstraints/mco:MD_LegalConstraints/mco:useLimitation"/>

          <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                            mri:resourceConstraints/mco:MD_LegalConstraints/mco:accessConstraints"/>
        </section>
      </tab>
      <tab id="medsea-metadata-tp" mode="flat">
        <section>

          <field xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:citation/cit:CI_Citation/cit:title"/>

          <!--<field
                  name="uniqueIdentifier"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                gmd:citation/gmd:CI_Citation/gmd:identifier/gmd:MD_Identifier/gmd:code"/>-->

          <field name="additionalInfo"
                 xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/mri:abstract"/>

          <field xpath="/mdb:MD_Metadata/mdb:defaultLocale/lan:PT_Locale/lan:language"
                 or="defaultLocale" in="/mdb:MD_Metadata"/>
          <!--<field xpath="/mdb:MD_Metadata/mdb:contact" or="contact" in="/mdb:MD_Metadata"/>-->



          <action type="add" name="metadataPointOfContact"
                  addDirective="data-gn-directory-entry-selector" or="contact" in="/mdb:MD_Metadata">

            <directiveAttributes
                    data-template-add-action="false"
                    data-template-type="contact"
                    data-variables="gmd:role/gmd:CI_RoleCode/@codeListValue~{{role}}"
                    data-transformation="contact-from-iso19139-to-iso19115-3"/>
          </action>

          <field name="metadataPointOfContact"
                 templateModeOnly="true"
                 notDisplayedIfMissing="true"
                 xpath="/mdb:MD_Metadata/mdb:contact"
                 del=".">
            <template>
              <values readonlyIf="count(@xlink:href) > 0">
                <key label="organisationName"
                     xpath="*/cit:party/*/cit:name/gco:CharacterString"/>
                <key label="electronicMailAddress"
                     xpath="*/cit:party/*/cit:contactInfo/*/cit:address/*/cit:electronicMailAddress/gco:CharacterString"
                     use="email"/>
                <key label="role"
                     xpath="*/cit:role/*/@codeListValue">
                  <codelist name="cit:CI_RoleCode"/>
                </key>
              </values>
              <snippet>
                <mdb:contact>
                  <cit:CI_Responsibility>
                    <cit:role>
                      <cit:CI_RoleCode codeList="codeListLocation#CI_RoleCode"
                                       codeListValue="{{role}}"></cit:CI_RoleCode>
                    </cit:role>
                    <gn:copy select="cit:extent"/>
                    <cit:party>
                      <cit:CI_Organisation>
                        <cit:name>
                          <gco:CharacterString>{{organisationName}}</gco:CharacterString>
                        </cit:name>
                        <cit:contactInfo>
                          <cit:CI_Contact>
                            <gn:copy select="cit:phone"/>
                            <cit:address>
                              <cit:CI_Address>
                                <cit:electronicMailAddress>
                                  <gco:CharacterString>{{electronicMailAddress}}</gco:CharacterString>
                                </cit:electronicMailAddress>
                              </cit:CI_Address>
                            </cit:address>
                            <gn:copy select="cit:onlineResource"/>
                            <gn:copy select="cit:hoursOfService"/>
                            <gn:copy select="cit:contactInstructions"/>
                            <gn:copy select="cit:contactType"/>
                          </cit:CI_Contact>
                        </cit:contactInfo>
                        <gn:copy select="cit:logo"/>
                        <gn:copy select="cit:individual"/>
                      </cit:CI_Organisation>
                    </cit:party>
                  </cit:CI_Responsibility>
                </mdb:contact>
              </snippet>
            </template>
          </field>

          <field name="challenge" xpath="/mdb:MD_Metadata/mdb:metadataScope/mdb:MD_MetadataScope/mdb:name"/>

          <field xpath="/mdb:MD_Metadata/mdb:dateInfo[*/cit:dateType/*/@codeListValue = 'revision']"/>


          <field
                  name="validation"
                  xpath="/mdb:MD_Metadata/mdb:identificationInfo/*/
                    mri:descriptiveKeywords
                    [contains(*/mri:thesaurusName/cit:CI_Citation/cit:identifier/*/mcc:code/*/text(),
                    'emodnet-checkpoint.status')]"/>
        </section>
      </tab>
    </view>




















    <view name="advanced">
      <tab id="identificationInfo" default="true">
        <section xpath="/mdb:MD_Metadata/mdb:identificationInfo" or="identificationInfo"
                 in="/mdb:MD_Metadata"/>
      </tab>
      <tab id="contentInfo">
        <section xpath="/mdb:MD_Metadata/mdb:contentInfo" or="contentInfo" in="/mdb:MD_Metadata"/>
      </tab>
      <tab id="distributionInfo">
        <section xpath="/mdb:MD_Metadata/mdb:distributionInfo" or="distributionInfo"
                 in="/mdb:MD_Metadata"/>
      </tab>
      <!--
      mdb:distributionInfo/mrd:MD_Distribution/mrd:transferOptions/mrd:MD_DigitalTransferOptions
      -->
      <tab id="dataQualityInfo">
        <section xpath="/mdb:MD_Metadata/mdb:dataQualityInfo" or="dataQualityInfo"
                 in="/mdb:MD_Metadata"/>
      </tab>
      <tab id="resourceLineage">
        <section xpath="/mdb:MD_Metadata/mdb:resourceLineage" or="resourceLineage"
                 in="/mdb:MD_Metadata"/>
      </tab>
      <tab id="spatialRepresentationInfo">
        <section xpath="/mdb:MD_Metadata/mdb:spatialRepresentationInfo"
                 or="spatialRepresentationInfo" in="/mdb:MD_Metadata"/>
      </tab>
      <tab id="referenceSystemInfo">
        <section xpath="/mdb:MD_Metadata/mdb:referenceSystemInfo" or="referenceSystemInfo"
                 in="/mdb:MD_Metadata"/>
      </tab>
      <tab id="acquisitionInformation" toggle="true">
        <section xpath="/mdb:MD_Metadata/mdb:acquisitionInformation" or="acquisitionInformation"
                 in="/mdb:MD_Metadata"/>
      </tab>
      <tab id="metadata">
        <section name="mdb:MD_Metadata">
          <field xpath="/mdb:MD_Metadata/mdb:metadataIdentifier"/>
          <field xpath="/mdb:MD_Metadata/mdb:defaultLocale" or="defaultLocale"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:otherLocale" or="otherLocale"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:contact" or="contact"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:parentMetadata" or="parentMetadata"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:metadataScope" or="metadataScope"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:alternativeMetadataReference" or="alternativeMetadataReference"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:metadataLinkage" or="metadataLinkage"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:dateInfo" or="dateInfo"
                 in="/mdb:MD_Metadata"/>
          <field xpath="/mdb:MD_Metadata/mdb:metadataStandard"/>
          <field xpath="/mdb:MD_Metadata/mdb:metadataProfile"/>
        </section>
      </tab>
      <tab id="portrayalCatalogueInfo" toggle="true">
        <section xpath="/mdb:MD_Metadata/mdb:portrayalCatalogueInfo" or="portrayalCatalogueInfo"
                 in="/mdb:MD_Metadata"/>
      </tab>
      <tab id="metadataConstraints" toggle="true">
        <section xpath="/mdb:MD_Metadata/mdb:metadataConstraints" or="metadataConstraints"
                 in="/mdb:MD_Metadata"/>
      </tab>
      <tab id="metadataMaintenance" toggle="true">
        <section xpath="/mdb:MD_Metadata/mdb:metadataMaintenance" or="metadataMaintenance"
                 in="/mdb:MD_Metadata"/>
      </tab>
      <tab id="applicationSchemaInfo" toggle="true">
        <section xpath="/mdb:MD_Metadata/mdb:applicationSchemaInfo" or="applicationSchemaInfo"
                 in="/mdb:MD_Metadata"/>
      </tab>
    </view>
    <view name="xml">
      <tab id="xml" default="true"/>
    </view>



  </views>
</editor>